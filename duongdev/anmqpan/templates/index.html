<!doctype html>
<html lang="vi">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chi·∫øn D·ªãch L√° Ch·∫Øn Xanh</title>
  
  <style>
    body {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Arial, sans-serif;
      background: linear-gradient(135deg, #0a1929 0%, #1a3a52 100%);
      color: #e0f2f7;
      min-height: 100%;
      width: 100%;
    }

    * {
      box-sizing: border-box;
    }

    .app-container {
      width: 100%;
      min-height: 100%;
      padding: 32px 24px;
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
    }

    .game-title {
      font-size: 42px;
      font-weight: 700;
      color: #00e5ff;
      text-shadow: 0 0 20px rgba(0, 229, 255, 0.5);
      margin: 0 0 12px 0;
      letter-spacing: 1px;
    }

    .subtitle {
      font-size: 18px;
      color: #80deea;
      margin: 0;
    }

    .progress-container {
      max-width: 900px;
      margin: 0 auto 40px auto;
      background: rgba(255, 255, 255, 0.05);
      padding: 24px;
      border-radius: 16px;
      border: 2px solid rgba(0, 229, 255, 0.3);
    }

    .progress-text {
      text-align: center;
      font-size: 20px;
      font-weight: 600;
      color: #00e5ff;
      margin-bottom: 16px;
    }

    .shield-pieces {
      display: flex;
      justify-content: center;
      gap: 12px;
      flex-wrap: wrap;
    }

    .shield-piece {
      width: 48px;
      height: 48px;
      border-radius: 8px;
      background: rgba(255, 255, 255, 0.1);
      border: 2px solid rgba(0, 229, 255, 0.3);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      transition: all 0.3s ease;
    }

    .shield-piece.collected {
      background: rgba(0, 229, 255, 0.2);
      border-color: #00e5ff;
      box-shadow: 0 0 20px rgba(0, 229, 255, 0.5);
    }

    .challenges-grid {
      max-width: 1200px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 24px;
    }

    .challenge-card {
      background: rgba(255, 255, 255, 0.08);
      border-radius: 16px;
      padding: 24px;
      border: 2px solid rgba(0, 229, 255, 0.3);
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .challenge-card:hover {
      transform: translateY(-4px);
      border-color: #00e5ff;
      box-shadow: 0 8px 24px rgba(0, 229, 255, 0.3);
    }

    .challenge-card.completed {
      border-color: #00ff88;
      background: rgba(0, 255, 136, 0.1);
    }

    .challenge-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 16px;
    }

    .challenge-number {
      width: 40px;
      height: 40px;
      background: rgba(0, 229, 255, 0.2);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      font-weight: 700;
      color: #00e5ff;
    }

    .challenge-card.completed .challenge-number {
      background: rgba(0, 255, 136, 0.3);
      color: #00ff88;
    }

    .challenge-title {
      font-size: 16px;
      font-weight: 600;
      color: #00e5ff;
      flex: 1;
    }

    .challenge-status {
      font-size: 12px;
      color: #80deea;
      text-align: center;
      margin-top: 12px;
      padding: 8px;
      background: rgba(0, 0, 0, 0.2);
      border-radius: 8px;
    }

    .challenge-card.completed .challenge-status {
      color: #00ff88;
    }

    .modal-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.85);
      z-index: 1000;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .modal-overlay.active {
      display: flex;
    }

    .modal-content {
      background: linear-gradient(135deg, #0a1929 0%, #1a3a52 100%);
      border-radius: 20px;
      padding: 32px;
      max-width: 700px;
      width: 100%;
      border: 2px solid #00e5ff;
      box-shadow: 0 0 40px rgba(0, 229, 255, 0.5);
      max-height: 90%;
      overflow-y: auto;
    }

    .modal-header {
      margin-bottom: 24px;
    }

    .modal-title {
      font-size: 24px;
      font-weight: 700;
      color: #00e5ff;
      margin: 0 0 8px 0;
    }

    .question-text {
      font-size: 18px;
      color: #e0f2f7;
      line-height: 1.6;
      margin: 0 0 24px 0;
    }

    .answers-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin-bottom: 24px;
    }

    .answer-btn {
      background: rgba(255, 255, 255, 0.08);
      border: 2px solid rgba(0, 229, 255, 0.3);
      color: #e0f2f7;
      padding: 16px 20px;
      border-radius: 12px;
      font-size: 16px;
      text-align: left;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: inherit;
      width: 100%;
    }

    .answer-btn:hover {
      background: rgba(0, 229, 255, 0.1);
      border-color: #00e5ff;
    }

    .answer-btn.correct {
      background: rgba(0, 255, 136, 0.2);
      border-color: #00ff88;
      color: #00ff88;
    }

    .answer-btn.incorrect {
      background: rgba(255, 82, 82, 0.2);
      border-color: #ff5252;
      color: #ff5252;
    }

    .answer-btn:disabled {
      cursor: not-allowed;
      opacity: 0.7;
    }

    .feedback {
      display: none;
      padding: 16px;
      border-radius: 12px;
      margin-bottom: 16px;
      font-size: 16px;
      text-align: center;
      font-weight: 600;
    }

    .feedback.show {
      display: block;
    }

    .feedback.correct {
      background: rgba(0, 255, 136, 0.2);
      border: 2px solid #00ff88;
      color: #00ff88;
    }

    .feedback.incorrect {
      background: rgba(255, 82, 82, 0.2);
      border: 2px solid #ff5252;
      color: #ff5252;
    }

    .modal-actions {
      display: flex;
      gap: 12px;
      justify-content: flex-end;
    }

    .btn {
      padding: 12px 24px;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      border: none;
      transition: all 0.3s ease;
      font-family: inherit;
    }

    .btn-close {
      background: rgba(255, 255, 255, 0.1);
      color: #e0f2f7;
      border: 2px solid rgba(255, 255, 255, 0.2);
    }

    .btn-close:hover {
      background: rgba(255, 255, 255, 0.15);
    }

    .btn-next {
      background: #00e5ff;
      color: #0a1929;
      display: none;
    }

    .btn-next.show {
      display: block;
    }

    .btn-next:hover {
      background: #00b8cc;
      box-shadow: 0 0 20px rgba(0, 229, 255, 0.5);
    }

    .completion-modal .modal-content {
      text-align: center;
      border-color: #00ff88;
      box-shadow: 0 0 60px rgba(0, 255, 136, 0.6);
    }

    .completion-icon {
      font-size: 80px;
      margin-bottom: 20px;
    }

    .completion-title {
      font-size: 32px;
      font-weight: 700;
      color: #00ff88;
      margin: 0 0 16px 0;
    }

    .completion-text {
      font-size: 20px;
      color: #80deea;
      margin: 0 0 32px 0;
    }

    @media (max-width: 768px) {
      .app-container {
        padding: 20px 16px;
      }

      .game-title {
        font-size: 32px;
      }

      .subtitle {
        font-size: 16px;
      }

      .challenges-grid {
        grid-template-columns: 1fr;
      }

      .modal-content {
        padding: 24px;
      }

      .modal-title {
        font-size: 20px;
      }

      .question-text {
        font-size: 16px;
      }
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="app-container">
   <div class="header">
    <h1 class="game-title" id="gameTitle">Chi·∫øn D·ªãch L√° Ch·∫Øn Xanh</h1>
    <p class="subtitle">GDQP-AN 10 ‚Ä¢ B·∫£o m·∫≠t An ninh m·∫°ng</p>
   </div>
   <div class="progress-container">
    <div class="progress-text">
     M·∫£nh Khi√™n ƒë√£ thu th·∫≠p: <span id="progressCount">0</span>/8
    </div>
    <div class="shield-pieces" id="shieldPieces"></div>
   </div>
   <div class="challenges-grid" id="challengesGrid"></div>
   <div class="modal-overlay" id="questionModal">
    <div class="modal-content">
     <div class="modal-header">
      <h2 class="modal-title" id="modalTitle"></h2>
      <p class="question-text" id="questionText"></p>
     </div>
     <div class="feedback" id="feedback"></div>
     <div class="answers-list" id="answersList"></div>
     <div class="modal-actions"><button class="btn btn-close" id="closeBtn">ƒê√≥ng</button> <button class="btn btn-next" id="nextBtn">Th·ª≠ th√°ch ti·∫øp theo</button>
     </div>
    </div>
   </div>
   <div class="modal-overlay completion-modal" id="completionModal">
    <div class="modal-content">
     <div class="completion-icon">
      üõ°Ô∏è
     </div>
     <h2 class="completion-title" id="completionTitle">K√≠ch ho·∫°t L√° Ch·∫Øn Xanh ‚Äì Ho√†n th√†nh nhi·ªám v·ª•!</h2>
     <p class="completion-text">B·∫°n ƒë√£ thu th·∫≠p ƒë·ªß 8 m·∫£nh khi√™n v√† ho√†n th√†nh t·∫•t c·∫£ th·ª≠ th√°ch b·∫£o m·∫≠t!</p><button class="btn btn-next" onclick="closeCompletionModal()">Ho√†n t·∫•t</button>
    </div>
   </div>
  </div>
  
  <audio id="background-audio" preload="auto"></audio>

  <script>
    const defaultConfig = {
      game_title: "Chi·∫øn D·ªãch L√° Ch·∫Øn Xanh",
      completion_message: "K√≠ch ho·∫°t L√° Ch·∫Øn Xanh ‚Äì Ho√†n th√†nh nhi·ªám v·ª•!"
    };

    // Danh s√°ch c√°c file nh·∫°c trong th∆∞ m·ª•c 'music/'
    // D∆Ø∆†NG PH·∫¢I THAY TH·∫æ DANH S√ÅCH N√ÄY b·∫±ng file .mp3 c·ªßa m nha
    const MUSIC_PLAYLIST = [
        "/duongdev/anmqpan/music/1.mp3",
        "/duongdev/anmqpan/music/2.mp3",
    ];

    let currentTrackIndex = 0;
    const audioPlayer = document.getElementById('background-audio');
    let isMusicStarted = false;

    function playNextTrack() {
        if (MUSIC_PLAYLIST.length === 0) {
            console.log("Playlist r·ªóng, kh√¥ng ph√°t nh·∫°c.");
            return;
        }

        // ƒê·∫∑t ngu·ªìn v√† ph√°t
        audioPlayer.src = MUSIC_PLAYLIST[currentTrackIndex];
        audioPlayer.play().catch(error => {
            console.warn("L·ªói t·ª± ƒë·ªông ph√°t (c√≥ th·ªÉ c·∫ßn t∆∞∆°ng t√°c ng∆∞·ªùi d√πng).", error);
        });

        // Thi·∫øt l·∫≠p khi b√†i h√°t k·∫øt th√∫c
        audioPlayer.onended = () => {
            currentTrackIndex = (currentTrackIndex + 1) % MUSIC_PLAYLIST.length; 
            playNextTrack();
        };
    }
    
    // H√†m c·ªë g·∫Øng b·∫Øt ƒë·∫ßu ph√°t nh·∫°c l·∫ßn ƒë·∫ßu
    function startMusicOnUserInteraction() {
        if (!isMusicStarted) {
            // ƒê·∫£m b·∫£o ch·ªâ c·ªë g·∫Øng ph√°t 1 l·∫ßn khi c√≥ t∆∞∆°ng t√°c ƒë·∫ßu ti√™n
            isMusicStarted = true;
            playNextTrack();
        }
    }

    // L·∫Øng nghe s·ª± ki·ªán click/tap tr√™n to√†n b·ªô trang ƒë·ªÉ b·∫Øt ƒë·∫ßu nh·∫°c
    document.addEventListener('click', startMusicOnUserInteraction, { once: true });
    document.addEventListener('touchstart', startMusicOnUserInteraction, { once: true });


    const challenges = [
      {
        id: 1,
        title: "Th·ª≠ th√°ch 1 ‚Äì Thu th·∫≠p M·∫£nh Khi√™n S·ªë 1",
        question: "ƒê√¢u l√† vai tr√≤ ch·ªß y·∫øu c·ªßa \"M·∫°ng\" theo ƒë·ªãnh nghƒ©a trong b√†i?",
        answers: [
          "A. Ch·ªâ l√† m√¥i tr∆∞·ªùng ƒë·ªÉ l∆∞u tr·ªØ d·ªØ li·ªáu.",
          "B. L√† m√¥i tr∆∞·ªùng ƒë·ªÉ c·∫•p, truy·ªÅn ƒë∆∞a, thu th·∫≠p, x·ª≠ l√Ω, l∆∞u tr·ªØ v√† trao ƒë·ªïi th√¥ng tin.",
          "C. Ch·ªâ l√† n∆°i k·∫øt n·ªëi c√°c thi·∫øt b·ªã ph·∫ßn c·ª©ng.",
          "D. L√† n∆°i ng∆∞·ªùi d√πng th·ª±c hi·ªán c√°c h√†nh vi x√£ h·ªôi"
        ],
        correct: 1
      },
      {
        id: 2,
        title: "Th·ª≠ th√°ch 2 ‚Äì Thu th·∫≠p M·∫£nh Khi√™n S·ªë 2",
        question: "Th√†nh ph·∫ßn n√†o KH√îNG thu·ªôc c·∫•u th√†nh c·ªßa Kh√¥ng gian m·∫°ng?",
        answers: [
          "A. M·∫°ng Internet v√† m·∫°ng m√°y t√≠nh.",
          "B. H·ªá th·ªëng x·ª≠ l√Ω v√† ƒëi·ªÅu khi·ªÉn th√¥ng tin.",
          "C. C∆° s·ªü d·ªØ li·ªáu v√† h·ªá th·ªëng th√¥ng tin.",
          "D. ƒê·ªãa ƒëi·ªÉm v·∫≠t l√Ω c·ªßa m√°y ch·ªß (Server)."
        ],
        correct: 3
      },
      {
        id: 3,
        title: "Th·ª≠ th√°ch 3 ‚Äì Thu th·∫≠p M·∫£nh Khi√™n S·ªë 3",
        question: "Kh·∫≥ng ƒë·ªãnh n√†o sau ƒë√¢y ƒê√öNG v·ªÅ Kh√¥ng gian m·∫°ng?",
        answers: [
          "A. L√† m√¥i tr∆∞·ªùng c√≥ gi·ªõi h·∫°n v·ªÅ kh√¥ng gian v√† th·ªùi gian.",
          "B. L√† m·∫°ng l∆∞·ªõi k·∫øt n·ªëi ch·ªâ c·ªßa c√°c m√°y t√≠nh c√° nh√¢n.",
          "C. L√† m·∫°ng l∆∞·ªõi k·∫øt n·ªëi c·ªßa c∆° s·ªü h·∫° t·∫ßng c√¥ng ngh·ªá th√¥ng tin v√† l√† n∆°i c√°c h√†nh vi x√£ h·ªôi kh√¥ng b·ªã gi·ªõi h·∫°n b·ªüi kh√¥ng gian v√† th·ªùi gian.",
          "D. Ch·ªâ bao g·ªìm c√°c thi·∫øt b·ªã k·∫øt n·ªëi kh√¥ng d√¢y."
        ],
        correct: 2
      },
      {
        id: 4,
        title: "Th·ª≠ th√°ch 4 ‚Äì Thu th·∫≠p M·∫£nh Khi√™n S·ªë 4",
        question: "Theo kh√°i ni·ªám, An ninh m·∫°ng gi√∫p b·∫£o v·ªá quy·ªÅn l·ª£i h·ª£p ph√°p c·ªßa c√°c ƒë·ªëi t∆∞·ª£ng n√†o?",
        answers: [
          "A. Ch·ªâ b·∫£o v·ªá An ninh qu·ªëc gia.",
          "B. Ch·ªâ b·∫£o v·ªá Tr·∫≠t t·ª± an to√†n x√£ h·ªôi.",
          "C. Ch·ªâ b·∫£o v·ªá c∆° quan t·ªï ch·ª©c, c√° nh√¢n.",
          "D. T·∫•t c·∫£ c√°c ƒë√°p √°n tr√™n (An ninh qu·ªëc gia, tr·∫≠t t·ª± an to√†n x√£ h·ªôi, v√† c∆° quan t·ªï ch·ª©c, c√° nh√¢n)."
        ],
        correct: 3
      },
      {
        id: 5,
        title: "Th·ª≠ th√°ch 5 ‚Äì Thu th·∫≠p M·∫£nh Khi√™n S·ªë 5",
        question: "Kh√°i ni·ªám \"An ninh m·∫°ng\" ƒë·ªÅ c·∫≠p ƒë·∫øn vi·ªác b·∫£o v·ªá ho·∫°t ƒë·ªông tr√™n m√¥i tr∆∞·ªùng n√†o?",
        answers: [
          "A. M·∫°ng vi·ªÖn th√¥ng.",
          "B. M·∫°ng m√°y t√≠nh.",
          "C. Kh√¥ng gian m·∫°ng.",
          "D. M·∫°ng n·ªôi b·ªô (LAN)."
        ],
        correct: 2
      },
      {
        id: 6,
        title: "Th·ª≠ th√°ch 6 ‚Äì Thu th·∫≠p M·∫£nh Khi√™n S·ªë 6",
        question: "T·∫°i sao vi·ªác ƒë·∫£m b·∫£o An ninh m·∫°ng l√† c·∫ßn thi·∫øt ƒë·ªëi v·ªõi c·∫£ c√° nh√¢n v√† qu·ªëc gia?",
        answers: [
          "A. Ch·ªâ ƒë·ªÉ tu√¢n th·ªß ph√°p lu·∫≠t.",
          "B. Ch·ªâ ƒë·ªÉ b·∫£o v·ªá c∆° s·ªü h·∫° t·∫ßng k·ªπ thu·∫≠t.",
          "C. V√¨ Kh√¥ng gian m·∫°ng l√† n∆°i di·ªÖn ra c√°c ho·∫°t ƒë·ªông x√£ h·ªôi quan tr·ªçng, c·∫ßn ƒë∆∞·ª£c b·∫£o v·ªá ƒë·ªÉ duy tr√¨ an to√†n x√£ h·ªôi v√† l·ª£i √≠ch h·ª£p ph√°p c·ªßa m·ªçi ch·ªß th·ªÉ.",
          "D. V√¨ ƒë√¢y l√† xu h∆∞·ªõng b·∫Øt bu·ªôc c·ªßa to√†n c·∫ßu."
        ],
        correct: 2
      },
      {
        id: 7,
        title: "Th·ª≠ th√°ch 7 ‚Äì Thu th·∫≠p M·∫£nh Khi√™n S·ªë 7",
        question: "T√¨nh hu·ªëng: M·ªôt nh√≥m hacker t·∫•n c√¥ng b·ªánh vi·ªán, m√£ h√≥a d·ªØ li·ªáu v√† ƒë√≤i ti·ªÅn chu·ªôc. H√†nh vi n√†y g√¢y ph∆∞∆°ng h·∫°i ƒë·∫øn ƒë·ªëi t∆∞·ª£ng n√†o?",
        answers: [
          "A. Ch·ªâ An ninh qu·ªëc gia.",
          "B. Ch·ªâ Tr·∫≠t t·ª± an to√†n x√£ h·ªôi.",
          "C. Quy·ªÅn v√† l·ª£i √≠ch h·ª£p ph√°p c·ªßa c∆° quan t·ªï ch·ª©c (b·ªánh vi·ªán) v√† c√° nh√¢n (b·ªánh nh√¢n).",
          "D. Ch·ªâ c∆° s·ªü h·∫° t·∫ßng c√¥ng ngh·ªá th√¥ng tin."
        ],
        correct: 2
      },
      {
        id: 8,
        title: "Th·ª≠ th√°ch 8 ‚Äì Thu th·∫≠p M·∫£nh Khi√™n S·ªë 8",
        question: "B·∫°n h·ªçp tr·ª±c tuy·∫øn kh√¥ng b·ªã gi·ªõi h·∫°n ƒë·ªãa l√Ω. ƒêi·ªÅu n√†y th·ªÉ hi·ªán ƒë·∫∑c ƒëi·ªÉm n√†o c·ªßa Kh√¥ng gian m·∫°ng?",
        answers: [
          "A. Ch·ªâ s·ª≠ d·ª•ng c√°p quang.",
          "B. Ng∆∞·ªùi th·ª±c hi·ªán h√†nh vi x√£ h·ªôi kh√¥ng b·ªã gi·ªõi h·∫°n b·ªüi kh√¥ng gian v√† th·ªùi gian.",
          "C. Ph·ª• thu·ªôc v√†o t·ªëc ƒë·ªô m·∫°ng n·ªôi b·ªô.",
          "D. Ch·ªâ gi·ªõi h·∫°n trong m·ªôt qu·ªëc gia."
        ],
        correct: 1
      }
    ];

    let completedChallenges = new Set();
    let currentChallengeId = null;

    function initApp() {
      renderShieldPieces();
      renderChallenges();
      updateProgress();
    }

    function renderShieldPieces() {
      const container = document.getElementById('shieldPieces');
      container.innerHTML = '';
      for (let i = 1; i <= 8; i++) {
        const piece = document.createElement('div');
        piece.className = 'shield-piece';
        piece.id = `shield-${i}`;
        piece.textContent = completedChallenges.has(i) ? 'üõ°Ô∏è' : i;
        if (completedChallenges.has(i)) {
          piece.classList.add('collected');
        }
        container.appendChild(piece);
      }
    }

    function renderChallenges() {
      const grid = document.getElementById('challengesGrid');
      grid.innerHTML = '';
      challenges.forEach(challenge => {
        const card = document.createElement('div');
        card.className = 'challenge-card';
        if (completedChallenges.has(challenge.id)) {
          card.classList.add('completed');
        }
        card.innerHTML = `
          <div class="challenge-header">
            <div class="challenge-number">${challenge.id}</div>
            <div class="challenge-title">${challenge.title}</div>
          </div>
          <div class="challenge-status">
            ${completedChallenges.has(challenge.id) ? '‚úì ƒê√£ ho√†n th√†nh' : 'Nh·∫•n ƒë·ªÉ b·∫Øt ƒë·∫ßu'}
          </div>
        `;
        card.addEventListener('click', () => openChallenge(challenge.id));
        grid.appendChild(card);
      });
    }

    function openChallenge(id) {
      currentChallengeId = id;
      const challenge = challenges.find(c => c.id === id);
      document.getElementById('modalTitle').textContent = challenge.title;
      document.getElementById('questionText').textContent = challenge.question;
      
      const answersList = document.getElementById('answersList');
      answersList.innerHTML = '';
      challenge.answers.forEach((answer, index) => {
        const btn = document.createElement('button');
        btn.className = 'answer-btn';
        btn.textContent = answer;
        btn.addEventListener('click', () => checkAnswer(index, challenge.correct));
        answersList.appendChild(btn);
      });

      document.getElementById('feedback').classList.remove('show', 'correct', 'incorrect');
      document.getElementById('nextBtn').classList.remove('show');
      document.getElementById('questionModal').classList.add('active');
    }

    function checkAnswer(selected, correct) {
      const buttons = document.querySelectorAll('.answer-btn');
      const feedback = document.getElementById('feedback');
      
      buttons.forEach((btn, index) => {
        btn.disabled = true;
        if (index === correct) {
          btn.classList.add('correct');
        } else if (index === selected && selected !== correct) {
          btn.classList.add('incorrect');
        }
      });

      if (selected === correct) {
        feedback.textContent = '‚úì Ch√≠nh x√°c! B·∫°n ƒë√£ thu th·∫≠p ƒë∆∞·ª£c m·∫£nh khi√™n n√†y!';
        feedback.classList.add('show', 'correct');
        completedChallenges.add(currentChallengeId);
        updateProgress();
        
        if (currentChallengeId < 8) {
          document.getElementById('nextBtn').classList.add('show');
        } else {
          setTimeout(checkCompletion, 1500);
        }
      } else {
        feedback.textContent = '‚úó Ch∆∞a ch√≠nh x√°c. H√£y th·ª≠ l·∫°i!';
        feedback.classList.add('show', 'incorrect');
        setTimeout(() => {
          buttons.forEach(btn => {
            btn.disabled = false;
            btn.classList.remove('correct', 'incorrect');
          });
          feedback.classList.remove('show');
        }, 2000);
      }
    }

    function updateProgress() {
      document.getElementById('progressCount').textContent = completedChallenges.size;
      renderShieldPieces();
      renderChallenges();
    }

    function checkCompletion() {
      if (completedChallenges.size === 8) {
        document.getElementById('questionModal').classList.remove('active');
        document.getElementById('completionModal').classList.add('active');
      }
    }

    function closeModal() {
      document.getElementById('questionModal').classList.remove('active');
    }

    function closeCompletionModal() {
      document.getElementById('completionModal').classList.remove('active');
    }

    function nextChallenge() {
      closeModal();
      if (currentChallengeId < 8) {
        openChallenge(currentChallengeId + 1);
      }
    }

    document.getElementById('closeBtn').addEventListener('click', closeModal);
    document.getElementById('nextBtn').addEventListener('click', nextChallenge);

    

    initApp();
  </script>
 </body>
</html>